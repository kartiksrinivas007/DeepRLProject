Running TD3 Hopper-medium with BC weight 100 on babel-m5-16
Sun Nov 16 18:35:19 EST 2025
============================================================
TD3 Training Configuration
============================================================
agent               : td3
alpha               : 0.2
batch_size          : 128
bc_regularization_weight: 100.0
clip_coef           : 0.2
cpu                 : False
cql_alpha           : 0.0
cql_n_actions       : 4
cql_temp            : 1.0
delay               : 2
ent_coef            : 0.01
env_id              : mujoco/hopper/medium-v0
eval_episodes       : 100
eval_every          : 50000
exploration_noise   : 0.1
gae_lambda          : 0.98
gamma               : 0.99
log_every           : 10000
lr                  : 0.0003
max_grad_norm       : 0.5
minibatch_size      : 128
noise_clip          : 0.5
out_dir             : runs/td3_mujoco/hopper/medium_v0/20251116-183523
plot_every          : 1000
policy_noise        : 0.2
rollout_steps       : 4096
seed                : 42000
tau                 : 0.005
total_steps         : 100000
update_epochs       : 10
update_every        : 1
utd_ratio           : 1
vf_coef             : 0.5
video_dir           : runs/td3_mujoco/hopper/medium_v0/20251116-183523/videos
video_every         : 100000
video_prefix        : eval
============================================================
Using device: cuda
Environment: mujoco/hopper/medium-v0
Obs dim: 11, Action dim: 3
Created TD3 agent
Starting TD3 training...
Target steps: 100000
Batch size: 128
Update every: 1
--------------------------------------------------
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
[Step    10000] Updates: 10000 | Actor: -48.3827 | C1:  0.4498 | C2:  0.4262 | α:  0.000 | Q1:   82.18 | Q2:   82.18 | DDPG: -48.3827 | BC:  0.3379 | Ret:     0.0
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
[Step    20000] Updates: 20000 | Actor: -115.5715 | C1:  1.2272 | C2:  1.1063 | α:  0.000 | Q1:  146.48 | Q2:  146.44 | DDPG: -115.5715 | BC:  0.3091 | Ret:     0.0
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
[Step    30000] Updates: 30000 | Actor: -165.3391 | C1:  1.3109 | C2:  0.9557 | α:  0.000 | Q1:  192.09 | Q2:  192.12 | DDPG: -165.3391 | BC:  0.2695 | Ret:     0.0
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
[Step    40000] Updates: 40000 | Actor: -207.1304 | C1:  2.4339 | C2:  2.2967 | α:  0.000 | Q1:  231.57 | Q2:  231.92 | DDPG: -207.1304 | BC:  0.2480 | Ret:     0.0
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
[Step    50000] Updates: 50000 | Actor: -234.5080 | C1:  4.8953 | C2:  5.0591 | α:  0.000 | Q1:  259.20 | Q2:  259.13 | DDPG: -234.5080 | BC:  0.2453 | Ret:     0.0

--- Evaluation at step 50000 ---
Warning: could not compute normalized score via Minari: Reference score not provided for dataset mujoco/hopper/medium-v0. Can't compute the normalized score.
Eval: 1220.0 ± 102.9
New best model saved! Return: 1220.0
--- End Evaluation ---

Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
[Step    60000] Updates: 60000 | Actor: -246.7789 | C1:  4.6814 | C2:  5.1315 | α:  0.000 | Q1:  274.44 | Q2:  274.95 | DDPG: -246.7789 | BC:  0.2800 | Ret:     0.0
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
[Step    70000] Updates: 70000 | Actor: -253.3577 | C1: 12.5658 | C2: 13.3536 | α:  0.000 | Q1:  275.34 | Q2:  276.05 | DDPG: -253.3577 | BC:  0.2247 | Ret:     0.0
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
[Step    80000] Updates: 80000 | Actor: -268.4870 | C1:  9.8578 | C2: 12.0733 | α:  0.000 | Q1:  294.82 | Q2:  294.72 | DDPG: -268.4870 | BC:  0.2675 | Ret:     0.0
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
[Step    90000] Updates: 90000 | Actor: -276.8608 | C1: 12.3538 | C2: 14.6198 | α:  0.000 | Q1:  298.55 | Q2:  297.64 | DDPG: -276.8608 | BC:  0.2185 | Ret:     0.0
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
[Step   100000] Updates: 100000 | Actor: -246.6039 | C1: 28.0043 | C2: 27.9601 | α:  0.000 | Q1:  268.12 | Q2:  269.74 | DDPG: -246.6039 | BC:  0.2264 | Ret:     0.0

--- Evaluation at step 100000 ---
Warning: could not compute normalized score via Minari: Reference score not provided for dataset mujoco/hopper/medium-v0. Can't compute the normalized score.
Eval: 1715.9 ± 507.6
New best model saved! Return: 1715.9
--- End Evaluation ---

Recording video at step 100000...
Video recording failed: Unexpected mode: None, expected modes: human, rgb_array, depth_array, or rgbd_tuple
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png

Training completed! Total steps: 100000
Total TD3 updates: 100000
Loaded best model from runs/td3_mujoco/hopper/medium_v0/20251116-183523/best.pt for final evaluation
Final evaluation...
Warning: could not compute normalized score via Minari: Reference score not provided for dataset mujoco/hopper/medium-v0. Can't compute the normalized score.
Final performance: 1730.3 ± 516.1
Training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Final training curves saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_curves.png
Final model saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/final.pt
Training log saved: runs/td3_mujoco/hopper/medium_v0/20251116-183523/training_log.json

All artifacts saved to: runs/td3_mujoco/hopper/medium_v0/20251116-183523
Training complete!
Sun Nov 16 18:44:13 EST 2025
